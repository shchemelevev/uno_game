Архитектура
===============

### Технологии

Сервер реализован на asyncio(python 3.5).
Для упрощения кода все реализовано как однопоточное приложение.
Для обмена сообщениями между сервером и клиентом использован протокол thrift.
Данный модуль используется исключительно для сериализации-десериализации
объектов при передаче данных.
Для хранение данных используется redis.


### Модель работы сервера

Сервер реализован с применением модели "реакция на события"(не уверен насчет русского названия).
Любое событие(изменение состояния игры, ввод пользователя, старт игры)
добавляется в очредь событий.
Сообщения из очереди изымаются менеджером событий и отправляются
на обработку подписанным на данный тип сообщения объектам.

Игровая логика изолирована от серверной логики за счет того что в события
передается только uid пользователя.

Логика работы ai отнесена к игровой логике и частично использует ее код.
AI реализован с рассчетом на то что его, после незначительной дорабокти,
можно будет запускать с удаленной машины для нагрузочного тестирования.


### Игровая логика
#### Объекты игровой логики
- Раунд - хранит состояние колоды, список игроков, список доступных в данный момент действий, текущего игрока, направление
перехода хода и т.п.
- Колода - хранит отбой, новые каты и активную на данный момент карту
- Игрок - хранит список карт пользователя и оповещает пользователя о событиях
- Действие - определяет доступность исполнения команды пользователя, изменяет состояние объектов "Раунт" и "Игрок"
- Карта - объект вынесен на уровень протокола, поскольку используется в клиенте и сервере.

#### Логика
В основе игровой логики лежит возможность выполениния пользователем определенных действий.
Выполенные действия определяют доступные действия для следующего игрока и оказывают влияние
на состояние объекта "Раунд".
Например: Действие "Взять карту" берет карту из колоды, добавляет ее в объект игрок, оповещает пользователя, и устанавливает в список доступных действий в раунде.
